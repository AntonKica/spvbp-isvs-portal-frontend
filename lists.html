<!DOCTYPE html>
<html lang="sk">
  <head>
    <meta charset="UTF-8">
    <title>Inici√°cia ISMS</title>

    <style>
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
    </style>
  </head>
  <body>
    <div id='assets'></div>
    <hr>
    <div id='roles'></div>
    <hr>
    <div id='humans'></div>
    <script>
      fetch('http://spvbp-isvs.local/svc/human/list')
        .then(response => response.json()) // Parse the JSON response
        .then(data => {
          var str = `<table>
            <caption> Human list </caption>
            <tr>
            <th> ID </th>
            <th> First name</th>
            <th> Last name</th>
            <th> Roles </th>
            </tr>
            `

          data.forEach(entity => {
            roles = ""
            if(entity.roles) {
              roles = entity.roles.map(role => role.name + ';')
            }
            str += `
              <tr> 
              <td> ${entity.id} </td> 
              <td> ${entity.firstName} </td> 
              <td> ${entity.lastName} </td> 
              <td> ${roles} </td> 
              </tr>`
          })
          str += `</table>`
          return str
        })
        .then(table => document.getElementById('humans').innerHTML = table)
        .catch(error => {
          // Handle any errors that occurred during the fetch
          console.error('Error fetching data:', error)
        })
      fetch('http://spvbp-isvs.local/svc/asset/list')
        .then(response => response.json()) // Parse the JSON response
        .then(data => {
          var str = `<table>
            <caption> Asset list </caption>
            <tr>
            <th> ID </th>
            <th> Asset name </th>
            </tr>
            `

          data.forEach(entity => {
            str += `
              <tr> 
              <td> ${entity.id} </td> 
              <td> ${entity.name} </td> 
              </tr>`
          })
          str += `</table>`
          return str
        })
        .then(table => document.getElementById('assets').innerHTML = table)
        .catch(error => {
          // Handle any errors that occurred during the fetch
          console.error('Error fetching data:', error)
        })
      fetch('http://spvbp-isvs.local/svc/role/list')
        .then(response => response.json()) // Parse the JSON response
        .then(data => {
          var str = `<table>
            <caption> Role list </caption>
            <tr>
            <th> ID </th>
            <th> Role name </th>
            <th> Humans </th>
            </tr>
            `

          data.forEach(entity => {
            humans = ""
            if(entity.humans) {
              humans = entity.humans.map(human => `${human.firstName} ${human.lastName};`)
            }
            str += `
              <tr> 
              <td> ${entity.id} </td> 
              <td> ${entity.name} </td> 
              <td> ${humans} </td> 
              </tr>`
          })
          str += `</table>`
          return str
        })
        .then(table => document.getElementById('roles').innerHTML = table)
        .catch(error => {
          // Handle any errors that occurred during the fetch
          console.error('Error fetching data:', error)
        })
    </script>
  </body>
</html>
